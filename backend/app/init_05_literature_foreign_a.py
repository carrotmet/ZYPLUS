# -*- coding: utf-8 -*-
"""
05 学科门类：文学 - 外国语言文学类（A部分）
包含：英语、俄语、德语、法语、西班牙语、阿拉伯语、日语等常见语种
"""

import sys
import os
import json

backend_path = 'D:/github.com/carrotmet/zyplusv2/backend'
if backend_path not in sys.path:
    sys.path.insert(0, backend_path)
os.chdir(backend_path)

from app.database import SessionLocal
from app import models

def get_or_create_discipline(db, name, code, description):
    """获取或创建学科门类"""
    discipline = db.query(models.Discipline).filter(models.Discipline.code == code).first()
    if not discipline:
        discipline = models.Discipline(name=name, code=code, description=description)
        db.add(discipline)
        db.commit()
        db.refresh(discipline)
        print(f"  创建学科门类: {name} (ID: {discipline.id})")
    else:
        print(f"  学科门类已存在: {name} (ID: {discipline.id})")
    return discipline

def get_or_create_category(db, name, code, discipline_id, description):
    """获取或创建专业类"""
    category = db.query(models.MajorCategory).filter(
        models.MajorCategory.code == code,
        models.MajorCategory.discipline_id == discipline_id
    ).first()
    if not category:
        category = models.MajorCategory(
            name=name, code=code, discipline_id=discipline_id, description=description
        )
        db.add(category)
        db.commit()
        db.refresh(category)
        print(f"    创建专业类: {name} (ID: {category.id})")
    else:
        print(f"    专业类已存在: {name} (ID: {category.id})")
    return category

def create_major_if_not_exists(db, name, code, category_id, description, duration, courses):
    """创建专业（如果不存在）"""
    existing = db.query(models.Major).filter(models.Major.code == code).first()
    if existing:
        print(f"      跳过: {name} (已存在)")
        return None
    
    major = models.Major(
        name=name,
        code=code,
        category_id=category_id,
        description=description,
        duration=duration,
        main_courses=json.dumps(courses, ensure_ascii=False)
    )
    db.add(major)
    db.commit()
    db.refresh(major)
    print(f"      创建专业: {name} (ID: {major.id})")
    return major

def init_literature_foreign_a_data():
    """初始化外国语言文学类数据（A部分：主要语种）"""
    print("=== 初始化 05 文学类数据（外国语言文学A：主要语种）===\n")
    db = SessionLocal()
    
    try:
        # 创建学科门类：文学
        discipline = get_or_create_discipline(
            db, "文学", "05",
            "文学学科门类，包含中国语言文学、外国语言文学、新闻传播学等专业类"
        )
        
        # 0502 外国语言文学类
        category = get_or_create_category(db, "外国语言文学类", "0502", discipline.id,
            "研究外国语言和文学的学科")
        
        # 主要语种（A部分）
        majors_data = [
            # 英语及主要欧洲语言
            ("英语", "050201", "培养从事英语教学、翻译、研究的专业人才",
             ["综合英语", "高级英语", "英语听力", "英语口语", "英语写作", "翻译理论与实践", "英美文学", "语言学概论"]),
            ("俄语", "050202", "培养从事俄语教学、翻译、研究的专业人才",
             ["基础俄语", "高级俄语", "俄语视听说", "俄语写作", "俄汉翻译", "俄罗斯文学", "俄罗斯国情", "俄语语言学"]),
            ("德语", "050203", "培养从事德语教学、翻译、研究的专业人才",
             ["基础德语", "高级德语", "德语视听说", "德语写作", "德汉翻译", "德国文学", "德国国情", "德语语言学"]),
            ("法语", "050204", "培养从事法语教学、翻译、研究的专业人才",
             ["基础法语", "高级法语", "法语视听说", "法语写作", "法汉翻译", "法国文学", "法国国情", "法语语言学"]),
            ("西班牙语", "050205", "培养从事西班牙语教学、翻译、研究的专业人才",
             ["基础西班牙语", "高级西班牙语", "西班牙语视听说", "西班牙语写作", "西汉翻译", "西班牙文学", "拉美文学", "西班牙语国家国情"]),
            ("阿拉伯语", "050206", "培养从事阿拉伯语教学、翻译、研究的专业人才",
             ["基础阿拉伯语", "高级阿拉伯语", "阿拉伯语视听说", "阿拉伯语写作", "阿汉翻译", "阿拉伯文学", "阿拉伯国家国情", "伊斯兰文化"]),
            ("日语", "050207", "培养从事日语教学、翻译、研究的专业人才",
             ["基础日语", "高级日语", "日语视听说", "日语写作", "日汉翻译", "日本文学", "日本国情", "日本文化"]),
            ("波斯语", "050208", "培养从事波斯语教学、翻译、研究的专业人才",
             ["基础波斯语", "高级波斯语", "波斯语视听说", "波斯语写作", "波汉翻译", "波斯文学", "伊朗国情", "伊朗文化"]),
            ("朝鲜语", "050209", "培养从事朝鲜语教学、翻译、研究的专业人才",
             ["基础朝鲜语", "高级朝鲜语", "朝鲜语视听说", "朝鲜语写作", "朝汉翻译", "朝鲜文学", "韩国文学", "朝鲜半岛国情"]),
            
            # 南亚、东南亚语言
            ("菲律宾语", "050210", "培养从事菲律宾语教学、翻译、研究的专业人才",
             ["基础菲律宾语", "高级菲律宾语", "菲律宾语视听说", "菲律宾语写作", "菲律宾文学", "菲律宾国情", "东南亚文化"]),
            ("梵语巴利语", "050211", "培养从事梵语巴利语研究的专业人才",
             ["基础梵语", "基础巴利语", "梵语语法", "梵语文学", "佛教经典", "印度哲学", "印度文化"]),
            ("印度尼西亚语", "050212", "培养从事印度尼西亚语教学、翻译、研究的专业人才",
             ["基础印尼语", "高级印尼语", "印尼语视听说", "印尼语写作", "印尼文学", "印尼国情", "东南亚文化"]),
            ("印地语", "050213", "培养从事印地语教学、翻译、研究的专业人才",
             ["基础印地语", "高级印地语", "印地语视听说", "印地语写作", "印地文学", "印度国情", "印度文化"]),
            ("柬埔寨语", "050214", "培养从事柬埔寨语教学、翻译、研究的专业人才",
             ["基础柬埔寨语", "高级柬埔寨语", "柬埔寨语视听说", "柬埔寨语写作", "柬埔寨文学", "柬埔寨国情", "东南亚文化"]),
            ("老挝语", "050215", "培养从事老挝语教学、翻译、研究的专业人才",
             ["基础老挝语", "高级老挝语", "老挝语视听说", "老挝语写作", "老挝文学", "老挝国情", "东南亚文化"]),
            ("缅甸语", "050216", "培养从事缅甸语教学、翻译、研究的专业人才",
             ["基础缅甸语", "高级缅甸语", "缅甸语视听说", "缅甸语写作", "缅甸文学", "缅甸国情", "东南亚文化"]),
            ("马来语", "050217", "培养从事马来语教学、翻译、研究的专业人才",
             ["基础马来语", "高级马来语", "马来语视听说", "马来语写作", "马来文学", "马来西亚国情", "东南亚文化"]),
            ("蒙古语", "050218", "培养从事蒙古语教学、翻译、研究的专业人才",
             ["基础蒙古语", "高级蒙古语", "蒙古语视听说", "蒙古语写作", "蒙古文学", "蒙古国情", "蒙古文化"]),
            ("僧伽罗语", "050219", "培养从事僧伽罗语教学、翻译、研究的专业人才",
             ["基础僧伽罗语", "高级僧伽罗语", "僧伽罗语视听说", "僧伽罗语写作", "僧伽罗文学", "斯里兰卡国情", "南亚文化"]),
            ("泰语", "050220", "培养从事泰语教学、翻译、研究的专业人才",
             ["基础泰语", "高级泰语", "泰语视听说", "泰语写作", "泰汉翻译", "泰国文学", "泰国国情", "东南亚文化"]),
            ("乌尔都语", "050221", "培养从事乌尔都语教学、翻译、研究的专业人才",
             ["基础乌尔都语", "高级乌尔都语", "乌尔都语视听说", "乌尔都语写作", "乌尔都文学", "巴基斯坦国情", "南亚文化"]),
            ("希伯来语", "050222", "培养从事希伯来语教学、翻译、研究的专业人才",
             ["基础希伯来语", "高级希伯来语", "希伯来语视听说", "希伯来语写作", "希伯来文学", "以色列国情", "犹太文化"]),
            ("越南语", "050223", "培养从事越南语教学、翻译、研究的专业人才",
             ["基础越南语", "高级越南语", "越南语视听说", "越南语写作", "越南文学", "越南国情", "东南亚文化"]),
            
            # 非洲语言
            ("豪萨语", "050224", "培养从事豪萨语教学、翻译、研究的专业人才",
             ["基础豪萨语", "高级豪萨语", "豪萨语视听说", "豪萨语写作", "豪萨文学", "尼日利亚国情", "西非文化"]),
            ("斯瓦希里语", "050225", "培养从事斯瓦希里语教学、翻译、研究的专业人才",
             ["基础斯瓦希里语", "高级斯瓦希里语", "斯瓦希里语视听说", "斯瓦希里语写作", "斯瓦希里文学", "东非国情", "东非文化"]),
            
            # 东欧语言
            ("阿尔巴尼亚语", "050226", "培养从事阿尔巴尼亚语教学、翻译、研究的专业人才",
             ["基础阿尔巴尼亚语", "高级阿尔巴尼亚语", "阿尔巴尼亚语视听说", "阿尔巴尼亚语写作", "阿尔巴尼亚文学", "阿尔巴尼亚国情", "巴尔干文化"]),
            ("保加利亚语", "050227", "培养从事保加利亚语教学、翻译、研究的专业人才",
             ["基础保加利亚语", "高级保加利亚语", "保加利亚语视听说", "保加利亚语写作", "保加利亚文学", "保加利亚国情", "巴尔干文化"]),
            ("波兰语", "050228", "培养从事波兰语教学、翻译、研究的专业人才",
             ["基础波兰语", "高级波兰语", "波兰语视听说", "波兰语写作", "波兰文学", "波兰国情", "中欧文化"]),
            ("捷克语", "050229", "培养从事捷克语教学、翻译、研究的专业人才",
             ["基础捷克语", "高级捷克语", "捷克语视听说", "捷克语写作", "捷克文学", "捷克国情", "中欧文化"]),
            ("斯洛伐克语", "050230", "培养从事斯洛伐克语教学、翻译、研究的专业人才",
             ["基础斯洛伐克语", "高级斯洛伐克语", "斯洛伐克语视听说", "斯洛伐克语写作", "斯洛伐克文学", "斯洛伐克国情", "中欧文化"]),
            ("罗马尼亚语", "050231", "培养从事罗马尼亚语教学、翻译、研究的专业人才",
             ["基础罗马尼亚语", "高级罗马尼亚语", "罗马尼亚语视听说", "罗马尼亚语写作", "罗马尼亚文学", "罗马尼亚国情", "巴尔干文化"]),
            ("葡萄牙语", "050232", "培养从事葡萄牙语教学、翻译、研究的专业人才",
             ["基础葡萄牙语", "高级葡萄牙语", "葡萄牙语视听说", "葡萄牙语写作", "葡萄牙文学", "巴西文学", "葡萄牙语国家国情"]),
            ("瑞典语", "050233", "培养从事瑞典语教学、翻译、研究的专业人才",
             ["基础瑞典语", "高级瑞典语", "瑞典语视听说", "瑞典语写作", "瑞典文学", "瑞典国情", "北欧文化"]),
            ("塞尔维亚语", "050234", "培养从事塞尔维亚语教学、翻译、研究的专业人才",
             ["基础塞尔维亚语", "高级塞尔维亚语", "塞尔维亚语视听说", "塞尔维亚语写作", "塞尔维亚文学", "塞尔维亚国情", "巴尔干文化"]),
            ("土耳其语", "050235", "培养从事土耳其语教学、翻译、研究的专业人才",
             ["基础土耳其语", "高级土耳其语", "土耳其语视听说", "土耳其语写作", "土耳其文学", "土耳其国情", "突厥文化"]),
            ("希腊语", "050236", "培养从事希腊语教学、翻译、研究的专业人才",
             ["基础希腊语", "高级希腊语", "希腊语视听说", "希腊语写作", "希腊文学", "希腊国情", "古希腊文化"]),
            ("匈牙利语", "050237", "培养从事匈牙利语教学、翻译、研究的专业人才",
             ["基础匈牙利语", "高级匈牙利语", "匈牙利语视听说", "匈牙利语写作", "匈牙利文学", "匈牙利国情", "中欧文化"]),
            ("意大利语", "050238", "培养从事意大利语教学、翻译、研究的专业人才",
             ["基础意大利语", "高级意大利语", "意大利语视听说", "意大利语写作", "意大利文学", "意大利国情", "南欧文化"]),
        ]
        for name, code, desc, courses in majors_data:
            create_major_if_not_exists(db, name, code, category.id, desc, 4, courses)
        
        print("\n=== 文学类（外国语言文学A）数据初始化完成 ===")
        
    finally:
        db.close()

if __name__ == "__main__":
    init_literature_foreign_a_data()
